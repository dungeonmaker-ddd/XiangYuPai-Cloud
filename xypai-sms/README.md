# ğŸ“± XyPai SMS å¾®æœåŠ¡

åŸºäºDDDï¼ˆé¢†åŸŸé©±åŠ¨è®¾è®¡ï¼‰å’Œäº‹ä»¶é©±åŠ¨æ¶æ„çš„ç°ä»£åŒ–çŸ­ä¿¡å¾®æœåŠ¡ã€‚

## ğŸ¯ æ ¸å¿ƒç‰¹æ€§

### ğŸ“‹ åŸºç¡€åŠŸèƒ½

- âœ… å¤šæ¸ é“çŸ­ä¿¡å‘é€ï¼ˆé˜¿é‡Œäº‘ã€è…¾è®¯äº‘ã€ç™¾åº¦äº‘ï¼‰
- âœ… æ™ºèƒ½è´Ÿè½½å‡è¡¡å’Œæ•…éšœè½¬ç§»
- âœ… çŸ­ä¿¡æ¨¡æ¿ç®¡ç†å’Œå†…å®¹å®¡æ ¸
- âœ… å¼‚æ­¥æ¶ˆæ¯å¤„ç†
- âœ… å‘é€çŠ¶æ€å®æ—¶è·Ÿè¸ª
- âœ… é»‘åå•ç®¡ç†
- âœ… å‘é€é¢‘ç‡é™åˆ¶

### ğŸ—ï¸ æ¶æ„ç‰¹ç‚¹

- **DDDæ¶æ„**ï¼šå€¼å¯¹è±¡ã€èšåˆæ ¹ã€é¢†åŸŸäº‹ä»¶ã€é¢†åŸŸæœåŠ¡
- **äº‹ä»¶é©±åŠ¨**ï¼šå¼‚æ­¥äº‹ä»¶å¤„ç†ï¼Œæ¾è€¦åˆè®¾è®¡
- **å¾®æœåŠ¡**ï¼šç‹¬ç«‹éƒ¨ç½²ï¼Œå¯æ‰©å±•
- **é«˜å¯ç”¨**ï¼šå¤šæ¸ é“å†—ä½™ï¼Œè‡ªåŠ¨æ•…éšœè½¬ç§»
- **é«˜æ€§èƒ½**ï¼šè¿æ¥æ± ã€ç¼“å­˜ã€å¼‚æ­¥å¤„ç†

## ğŸ“ é¡¹ç›®ç»“æ„

```
xypai-sms/
â”œâ”€â”€ sms-interface/                    # ğŸ“¡ æ¥å£å®šä¹‰æ¨¡å—
â”‚   â””â”€â”€ src/main/java/com/xypai/sms/
â”‚       â”œâ”€â”€ api/                      # ğŸ”Œ Feignæ¥å£
â”‚       â””â”€â”€ dto/                      # ğŸ“¦ æ•°æ®ä¼ è¾“å¯¹è±¡
â”‚
â””â”€â”€ sms-service/                      # ğŸ¯ æœåŠ¡å®ç°æ¨¡å—
    â””â”€â”€ src/main/java/com/xypai/sms/
        â”œâ”€â”€ domain/                   # ğŸ­ é¢†åŸŸå±‚
        â”‚   â”œâ”€â”€ model/               # ğŸ›ï¸ èšåˆæ ¹å’Œå®ä½“
        â”‚   â”‚   â””â”€â”€ valueobject/     # ğŸ’ å€¼å¯¹è±¡
        â”‚   â”œâ”€â”€ event/               # ğŸ“¢ é¢†åŸŸäº‹ä»¶
        â”‚   â”œâ”€â”€ service/             # ğŸ”§ é¢†åŸŸæœåŠ¡
        â”‚   â””â”€â”€ repository/          # ğŸ—„ï¸ ä»“å‚¨æ¥å£
        â”‚
        â”œâ”€â”€ application/             # ğŸª åº”ç”¨å±‚
        â”‚   â”œâ”€â”€ service/            # ğŸ¬ åº”ç”¨æœåŠ¡
        â”‚   â”œâ”€â”€ command/            # ğŸ“ å‘½ä»¤å¯¹è±¡
        â”‚   â”œâ”€â”€ query/              # ğŸ” æŸ¥è¯¢å¯¹è±¡
        â”‚   â””â”€â”€ eventhandler/       # ğŸ¯ äº‹ä»¶å¤„ç†å™¨
        â”‚
        â”œâ”€â”€ infrastructure/         # ğŸ—ï¸ åŸºç¡€è®¾æ–½å±‚
        â”‚   â”œâ”€â”€ persistence/        # ğŸ’¾ æŒä¹…åŒ–
        â”‚   â”œâ”€â”€ channel/            # ğŸ“¡ æ¸ é“å®ç°
        â”‚   â”œâ”€â”€ cache/              # ğŸš€ ç¼“å­˜
        â”‚   â””â”€â”€ mq/                 # ğŸ“¨ æ¶ˆæ¯é˜Ÿåˆ—
        â”‚
        â””â”€â”€ interfaces/             # ğŸŒ æ¥å£å±‚
            â”œâ”€â”€ web/                # ğŸ–¥ï¸ RESTæ§åˆ¶å™¨
            â””â”€â”€ dto/                # ğŸ“‹ DTOè½¬æ¢å™¨
```

## ğŸš€ æ ¸å¿ƒç»„ä»¶

### ğŸ“± å€¼å¯¹è±¡ (Value Objects)

- **PhoneNumber**: æ‰‹æœºå·éªŒè¯å’Œè¿è¥å•†è¯†åˆ«
- **SmsContent**: çŸ­ä¿¡å†…å®¹æ¨¡æ¿å¤„ç†
- **ChannelType**: æ¸ é“ç±»å‹æšä¸¾

### ğŸ›ï¸ èšåˆæ ¹ (Aggregate Roots)

- **SmsTemplate**: çŸ­ä¿¡æ¨¡æ¿ç®¡ç†
- **SmsSendTask**: å‘é€ä»»åŠ¡åè°ƒ
- **SmsChannel**: æ¸ é“é…ç½®ç®¡ç†

### ğŸ“¢ é¢†åŸŸäº‹ä»¶ (Domain Events)

- **SmsTemplateCreatedEvent**: æ¨¡æ¿åˆ›å»ºäº‹ä»¶
- **SmsTemplateStatusChangedEvent**: æ¨¡æ¿çŠ¶æ€å˜æ›´äº‹ä»¶
- **SmsSentEvent**: çŸ­ä¿¡å‘é€äº‹ä»¶
- **SmsDeliveredEvent**: çŸ­ä¿¡é€è¾¾äº‹ä»¶

## ğŸ”§ æŠ€æœ¯æ ˆ

### åç«¯æ¡†æ¶

- **Spring Boot 3.2.0**: åŸºç¡€æ¡†æ¶
- **Spring Cloud 2023.0.0**: å¾®æœåŠ¡ç”Ÿæ€
- **MyBatis Plus 3.5.5**: æ•°æ®è®¿é—®å±‚

### æ•°æ®å­˜å‚¨

- **MySQL 8.0**: ä¸»æ•°æ®åº“
- **Redis**: ç¼“å­˜å’Œä¼šè¯å­˜å‚¨
- **RabbitMQ**: æ¶ˆæ¯é˜Ÿåˆ—

### çŸ­ä¿¡æ¸ é“

- **é˜¿é‡Œäº‘çŸ­ä¿¡**: ä¸»è¦æ¸ é“
- **è…¾è®¯äº‘çŸ­ä¿¡**: å¤‡ç”¨æ¸ é“
- **ç™¾åº¦äº‘çŸ­ä¿¡**: è¡¥å……æ¸ é“

### ç›‘æ§è¿ç»´

- **Spring Boot Actuator**: åº”ç”¨ç›‘æ§
- **Prometheus**: æŒ‡æ ‡æ”¶é›†
- **Knife4j**: APIæ–‡æ¡£

## ğŸƒâ€â™‚ï¸ å¿«é€Ÿå¼€å§‹

### ğŸ“‹ å‰ç½®æ¡ä»¶

- JDK 21+
- Maven 3.6+
- MySQL 8.0+
- Redis 6.0+
- RabbitMQ 3.8+

### ğŸ—„ï¸ æ•°æ®åº“åˆå§‹åŒ–

```sql
-- æ‰§è¡Œæ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
source sms-service/src/main/resources/sql/init_xypai_sms_schema.sql
```

### âš™ï¸ é…ç½®è¯´æ˜

```yaml
# application.yml å…³é”®é…ç½®
xypai:
  sms:
    channels:
      aliyun:
        enabled: true
        access-key-id: ${ALIYUN_ACCESS_KEY_ID}
        access-key-secret: ${ALIYUN_ACCESS_KEY_SECRET}
      tencent:
        enabled: true
        secret-id: ${TENCENT_SECRET_ID}
        secret-key: ${TENCENT_SECRET_KEY}
        sdk-app-id: ${TENCENT_SMS_SDK_APP_ID}
```

### ğŸš€ å¯åŠ¨æœåŠ¡

```bash
# ç¼–è¯‘é¡¹ç›®
mvn clean compile

# å¯åŠ¨æœåŠ¡
mvn spring-boot:run -pl sms-service
```

## ğŸ“– API ä½¿ç”¨ç¤ºä¾‹

### ğŸ“¤ å‘é€éªŒè¯ç çŸ­ä¿¡

```bash
curl -X POST http://localhost:9107/api/v1/sms/send \
  -H "Content-Type: application/json" \
  -d '{
    "templateCode": "USER_REGISTER_VERIFY",
    "phoneNumbers": ["13800138000"],
    "templateParams": {
      "code": "123456",
      "minutes": "5"
    },
    "async": false
  }'
```

### ğŸ“‹ æŸ¥è¯¢æ¨¡æ¿åˆ—è¡¨

```bash
curl -X GET "http://localhost:9107/api/v1/sms/templates?templateType=VERIFICATION"
```

### ğŸ“Š æŸ¥è¯¢å‘é€çŠ¶æ€

```bash
curl -X GET "http://localhost:9107/api/v1/sms/send/{taskId}/status"
```

## ğŸ¯ ä¸šåŠ¡åœºæ™¯

### éªŒè¯ç çŸ­ä¿¡

- ç”¨æˆ·æ³¨å†ŒéªŒè¯
- å¯†ç é‡ç½®éªŒè¯
- ç™»å½•å®‰å…¨éªŒè¯
- æ”¯ä»˜ç¡®è®¤éªŒè¯

### é€šçŸ¥çŸ­ä¿¡

- è®¢å•çŠ¶æ€é€šçŸ¥
- è´¦æˆ·å®‰å…¨æé†’
- ç³»ç»Ÿç»´æŠ¤é€šçŸ¥
- æ´»åŠ¨æ¨é€æ¶ˆæ¯

### è¥é”€çŸ­ä¿¡

- ä¿ƒé”€æ´»åŠ¨æ¨å¹¿
- æ–°å“å‘å¸ƒé€šçŸ¥
- ä¼šå‘˜æƒç›Šæé†’
- ç”Ÿæ—¥ç¥ç¦æ¶ˆæ¯

## ğŸ” ç›‘æ§ä¸è¿ç»´

### ğŸ“Š ç›‘æ§æŒ‡æ ‡

- å‘é€æˆåŠŸç‡
- æ¸ é“å“åº”æ—¶é—´
- é”™è¯¯ç‡ç»Ÿè®¡
- é˜Ÿåˆ—ç§¯å‹æƒ…å†µ

### ğŸš¨ å‘Šè­¦é…ç½®

- å‘é€å¤±è´¥ç‡è¶…é˜ˆå€¼
- æ¸ é“ä¸å¯ç”¨
- é˜Ÿåˆ—ç§¯å‹è¿‡å¤š
- ç³»ç»Ÿèµ„æºå¼‚å¸¸

### ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

- è¿æ¥æ± ä¼˜åŒ–
- ç¼“å­˜ç­–ç•¥è°ƒæ•´
- æ‰¹é‡å‘é€ä¼˜åŒ–
- æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

## ğŸ“„ å¼€æºåè®®

æœ¬é¡¹ç›®åŸºäº MIT åè®®å¼€æº - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ‘¥ è”ç³»æˆ‘ä»¬

- **é¡¹ç›®ä¸»é¡µ**: https://github.com/xypai/xypai-sms
- **é—®é¢˜åé¦ˆ**: https://github.com/xypai/xypai-sms/issues
- **é‚®ç®±**: xypai-team@example.com

---

ğŸ‰ **æ„Ÿè°¢ä½¿ç”¨ XyPai SMS å¾®æœåŠ¡ï¼**
